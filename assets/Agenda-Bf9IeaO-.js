import{b as D,r as m,j as e,q as E,o as F,s as M,v as T,g as P,X as q}from"./index-_bVLjU0W.js";import{P as k}from"./plus-BGjHXw1Y.js";import{C as z,a as R}from"./chevron-right-E1g4pxCT.js";import{U as _,P as $}from"./user-DLOUiDJc.js";import{C as O}from"./circle-alert-CzjK0qgp.js";const w=M("08:00","18:00",30);function X(){const{patients:n,addAppointment:f,updateAppointment:h,deleteAppointment:v,getAppointmentsByDate:g}=D(),[c,x]=m.useState(new Date),[s,i]=m.useState(!1),[o,r]=m.useState(null),[a,d]=m.useState(null),u=c.toISOString().split("T")[0],p=g(u),j=l=>{const t=new Date(c);t.setDate(t.getDate()+l),x(t)},b=()=>{x(new Date)},S=l=>p.find(t=>t.horaInicio===l),N=(l,t)=>{r(l||null),d(t||null),i(!0)},y=()=>{i(!1),r(null),d(null)},I=(l,t)=>{h(l,{status:t})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Agenda"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie as consultas do dia"})]}),e.jsxs("button",{onClick:()=>N(),className:"btn-primary flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5"}),"Nova Consulta"]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:()=>j(-1),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:e.jsx(z,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:E(c)}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:F(c,"EEEE, dd 'de' MMMM 'de' yyyy")})]}),e.jsx("button",{onClick:()=>j(1),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:e.jsx(R,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("button",{onClick:b,className:"btn-secondary text-sm",children:"Ir para hoje"})})]}),e.jsxs("div",{className:"card p-0 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3",children:e.jsxs("h2",{className:"font-medium text-gray-900",children:[p.length," consulta(s) agendada(s)"]})}),e.jsx("div",{className:"divide-y divide-gray-100",children:w.map(l=>{const t=S(l),A=t?n.find(C=>C.id===t.patientId):null;return e.jsxs("div",{className:`flex items-stretch hover:bg-gray-50 transition-colors ${t?"bg-white":"bg-gray-50/50"}`,children:[e.jsx("div",{className:"w-20 p-4 border-r border-gray-100 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-500",children:l})}),e.jsx("div",{className:"flex-1 p-4",children:t?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 cursor-pointer",onClick:()=>N(t),children:[e.jsx("div",{className:"w-10 h-10 bg-sky-100 rounded-full flex items-center justify-center",children:e.jsx(_,{className:"w-5 h-5 text-sky-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900",children:A?.nome||"Paciente não encontrado"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx("span",{children:T(t.tipo)}),t.motivo&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{className:"truncate",children:t.motivo})]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("select",{value:t.status,onChange:C=>I(t.id,C.target.value),className:`status-badge ${P(t.status)} border-0 cursor-pointer`,children:[e.jsx("option",{value:"agendada",children:"Agendada"}),e.jsx("option",{value:"confirmada",children:"Confirmada"}),e.jsx("option",{value:"aguardando",children:"Aguardando"}),e.jsx("option",{value:"em_atendimento",children:"Em atendimento"}),e.jsx("option",{value:"finalizada",children:"Finalizada"}),e.jsx("option",{value:"cancelada",children:"Cancelada"}),e.jsx("option",{value:"faltou",children:"Não compareceu"})]})})]}):e.jsxs("button",{onClick:()=>N(void 0,l),className:"w-full h-full flex items-center justify-center text-gray-400 hover:text-sky-600 transition-colors",children:[e.jsx(k,{className:"w-5 h-5"}),e.jsx("span",{className:"ml-2 text-sm",children:"Agendar"})]})})]},l)})})]}),s&&e.jsx(U,{appointment:o,selectedDate:u,selectedTime:a,patients:n,onClose:y,onSave:l=>{o?h(o.id,l):f(l),y()},onDelete:o?()=>{v(o.id),y()}:void 0})]})}function U({appointment:n,selectedDate:f,selectedTime:h,patients:v,onClose:g,onSave:c,onDelete:x}){const[s,i]=m.useState({patientId:n?.patientId||"",data:n?.data||f,horaInicio:n?.horaInicio||h||"09:00",horaFim:n?.horaFim||"",tipo:n?.tipo||"primeira_consulta",status:n?.status||"agendada",motivo:n?.motivo||"",valor:n?.valor?.toString()||"",convenio:n?.convenio||!1,observacoes:n?.observacoes||""});m.useEffect(()=>{if(s.horaInicio&&!s.horaFim){const[a,d]=s.horaInicio.split(":").map(Number),u=a*60+d+30,p=Math.floor(u/60),j=u%60;i(b=>({...b,horaFim:`${p.toString().padStart(2,"0")}:${j.toString().padStart(2,"0")}`}))}},[s.horaInicio]);const o=a=>{a.preventDefault();const d={patientId:s.patientId,data:s.data,horaInicio:s.horaInicio,horaFim:s.horaFim,tipo:s.tipo,status:s.status,motivo:s.motivo||void 0,valor:s.valor?parseFloat(s.valor):void 0,convenio:s.convenio,observacoes:s.observacoes||void 0};c(d)},r=v.find(a=>a.id===s.patientId);return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Editar Consulta":"Nova Consulta"}),e.jsx("button",{onClick:g,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:e.jsx(q,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paciente *"}),e.jsxs("select",{value:s.patientId,onChange:a=>i({...s,patientId:a.target.value}),className:"input-field",required:!0,children:[e.jsx("option",{value:"",children:"Selecione um paciente"}),v.map(a=>e.jsx("option",{value:a.id,children:a.nome},a.id))]}),r&&e.jsxs("div",{className:"mt-2 p-2 bg-gray-50 rounded-lg flex items-center gap-2 text-sm text-gray-600",children:[e.jsx($,{className:"w-4 h-4"}),r.telefone,r.alergias&&r.alergias.length>0&&e.jsxs("span",{className:"ml-auto flex items-center gap-1 text-red-600",children:[e.jsx(O,{className:"w-4 h-4"}),"Alergias: ",r.alergias.join(", ")]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data *"}),e.jsx("input",{type:"date",value:s.data,onChange:a=>i({...s,data:a.target.value}),className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Início *"}),e.jsx("select",{value:s.horaInicio,onChange:a=>i({...s,horaInicio:a.target.value,horaFim:""}),className:"input-field",required:!0,children:w.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fim *"}),e.jsx("select",{value:s.horaFim,onChange:a=>i({...s,horaFim:a.target.value}),className:"input-field",required:!0,children:w.filter(a=>a>s.horaInicio).map(a=>e.jsx("option",{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de consulta *"}),e.jsxs("select",{value:s.tipo,onChange:a=>i({...s,tipo:a.target.value}),className:"input-field",children:[e.jsx("option",{value:"primeira_consulta",children:"Primeira consulta"}),e.jsx("option",{value:"retorno",children:"Retorno"}),e.jsx("option",{value:"urgencia",children:"Urgência"}),e.jsx("option",{value:"exame",children:"Exame"}),e.jsx("option",{value:"procedimento",children:"Procedimento"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:s.status,onChange:a=>i({...s,status:a.target.value}),className:"input-field",children:[e.jsx("option",{value:"agendada",children:"Agendada"}),e.jsx("option",{value:"confirmada",children:"Confirmada"}),e.jsx("option",{value:"aguardando",children:"Aguardando"}),e.jsx("option",{value:"em_atendimento",children:"Em atendimento"}),e.jsx("option",{value:"finalizada",children:"Finalizada"}),e.jsx("option",{value:"cancelada",children:"Cancelada"}),e.jsx("option",{value:"faltou",children:"Não compareceu"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo da consulta"}),e.jsx("input",{type:"text",value:s.motivo,onChange:a=>i({...s,motivo:a.target.value}),className:"input-field",placeholder:"Ex: Check-up, Dor de cabeça..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor (R$)"}),e.jsx("input",{type:"number",value:s.valor,onChange:a=>i({...s,valor:a.target.value}),className:"input-field",placeholder:"0,00",step:"0.01"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.convenio,onChange:a=>i({...s,convenio:a.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-sky-600 focus:ring-sky-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Consulta por convênio"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),e.jsx("textarea",{value:s.observacoes,onChange:a=>i({...s,observacoes:a.target.value}),className:"input-field",rows:2})]}),e.jsxs("div",{className:"flex gap-3 justify-between pt-4 border-t border-gray-200",children:[e.jsx("div",{children:x&&e.jsx("button",{type:"button",onClick:x,className:"btn-danger",children:"Excluir"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:g,className:"btn-secondary",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn-primary",children:n?"Salvar":"Agendar"})]})]})]})]})})}export{X as default};
