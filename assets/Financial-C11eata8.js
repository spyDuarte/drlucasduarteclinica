import{c as h,d as _,r as o,j as e,h as P,f as m,e as L,D as T,o as A,z as F,B as R,g as $,q as v,X as q}from"./index-BT7t7-AV.js";import{P as z}from"./plus-BOtOl9uJ.js";const E=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],B=h("banknote",E);const O=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],X=h("credit-card",O);const G=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],H=h("receipt",G);const Z=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],J=h("smartphone",Z);function W(){const{payments:l,patients:r,addPayment:d,updatePayment:x}=_(),[t,c]=o.useState(""),[i,s]=o.useState("all"),[u,p]=o.useState(!1),[g,b]=o.useState(null),k=l.filter(a=>a.status==="pago").reduce((a,n)=>a+n.valor,0),C=l.filter(a=>a.status==="pendente").reduce((a,n)=>a+n.valor,0),N=new Date;N.setDate(1);const S=l.filter(a=>a.status==="pago"&&new Date(a.dataPagamento||a.createdAt)>=N).reduce((a,n)=>a+n.valor,0),f=l.filter(a=>{const j=r.find(V=>V.id===a.patientId)?.nome.toLowerCase().includes(t.toLowerCase())||a.descricao.toLowerCase().includes(t.toLowerCase()),I=i==="all"||a.status===i;return j&&I}).sort((a,n)=>new Date(n.createdAt).getTime()-new Date(a.createdAt).getTime()),y=a=>{b(a||null),p(!0)},w=()=>{p(!1),b(null)},D=a=>{x(a,{status:"pago",dataPagamento:new Date().toISOString().split("T")[0]})},M=a=>{switch(a){case"cartao_credito":case"cartao_debito":return e.jsx(X,{className:"w-4 h-4"});case"pix":return e.jsx(J,{className:"w-4 h-4"});default:return e.jsx(B,{className:"w-4 h-4"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Financeiro"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie pagamentos e recebimentos"})]}),e.jsxs("button",{onClick:()=>y(),className:"btn-primary flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5"}),"Novo Lançamento"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"card flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(P,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Recebido no mês"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:m(S)})]})]}),e.jsxs("div",{className:"card flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx(L,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pendente"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:m(C)})]})]}),e.jsxs("div",{className:"card flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-sky-100 rounded-lg flex items-center justify-center",children:e.jsx(T,{className:"w-6 h-6 text-sky-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total recebido"}),e.jsx("p",{className:"text-2xl font-bold text-sky-600",children:m(k)})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:t,onChange:a=>c(a.target.value),placeholder:"Buscar por paciente ou descrição...",className:"input-field pl-10"})]}),e.jsxs("select",{value:i,onChange:a=>s(a.target.value),className:"input-field w-auto",children:[e.jsx("option",{value:"all",children:"Todos os status"}),e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"pago",children:"Pago"}),e.jsx("option",{value:"cancelado",children:"Cancelado"})]})]}),e.jsx("div",{className:"card p-0 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-header",children:"Paciente"}),e.jsx("th",{className:"table-header",children:"Descrição"}),e.jsx("th",{className:"table-header",children:"Valor"}),e.jsx("th",{className:"table-header",children:"Forma de Pagamento"}),e.jsx("th",{className:"table-header",children:"Status"}),e.jsx("th",{className:"table-header",children:"Data"}),e.jsx("th",{className:"table-header text-right",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:f.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-8 text-gray-500",children:"Nenhum lançamento encontrado"})}):f.map(a=>{const n=r.find(j=>j.id===a.patientId);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"table-cell",children:e.jsx("span",{className:"font-medium",children:n?.nome||"N/A"})}),e.jsx("td",{className:"table-cell text-gray-600",children:a.descricao}),e.jsx("td",{className:"table-cell",children:e.jsx("span",{className:"font-semibold text-gray-900",children:m(a.valor)})}),e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"flex items-center gap-2",children:[M(a.formaPagamento),e.jsx("span",{children:F(a.formaPagamento)})]})}),e.jsx("td",{className:"table-cell",children:e.jsx("span",{className:`status-badge ${$(a.status)}`,children:R(a.status)})}),e.jsx("td",{className:"table-cell text-gray-600",children:a.dataPagamento?v(a.dataPagamento):a.dataVencimento?`Vence: ${v(a.dataVencimento)}`:v(a.createdAt)}),e.jsx("td",{className:"table-cell text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.status==="pendente"&&e.jsx("button",{onClick:()=>D(a.id),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Marcar como pago",children:e.jsx(P,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>y(a),className:"p-2 text-gray-500 hover:text-sky-600 hover:bg-sky-50 rounded-lg transition-colors",title:"Editar",children:e.jsx(H,{className:"w-5 h-5"})})]})})]},a.id)})})]})}),u&&e.jsx(K,{payment:g,patients:r,onClose:w,onSave:a=>{g?x(g.id,a):d(a),w()}})]})}function K({payment:l,patients:r,onClose:d,onSave:x}){const[t,c]=o.useState({patientId:l?.patientId||"",valor:l?.valor?.toString()||"",descricao:l?.descricao||"Consulta",formaPagamento:l?.formaPagamento||"pix",status:l?.status||"pendente",dataPagamento:l?.dataPagamento||"",dataVencimento:l?.dataVencimento||"",observacoes:l?.observacoes||""}),i=s=>{s.preventDefault();const u={patientId:t.patientId,valor:parseFloat(t.valor),descricao:t.descricao,formaPagamento:t.formaPagamento,status:t.status,dataPagamento:t.dataPagamento||void 0,dataVencimento:t.dataVencimento||void 0,observacoes:t.observacoes||void 0};x(u)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md",children:[e.jsxs("div",{className:"border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:l?"Editar Lançamento":"Novo Lançamento"}),e.jsx("button",{onClick:d,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:e.jsx(q,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paciente *"}),e.jsxs("select",{value:t.patientId,onChange:s=>c({...t,patientId:s.target.value}),className:"input-field",required:!0,children:[e.jsx("option",{value:"",children:"Selecione um paciente"}),r.map(s=>e.jsx("option",{value:s.id,children:s.nome},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição *"}),e.jsx("input",{type:"text",value:t.descricao,onChange:s=>c({...t,descricao:s.target.value}),className:"input-field",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor (R$) *"}),e.jsx("input",{type:"number",step:"0.01",value:t.valor,onChange:s=>c({...t,valor:s.target.value}),className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Forma de pagamento"}),e.jsxs("select",{value:t.formaPagamento,onChange:s=>c({...t,formaPagamento:s.target.value}),className:"input-field",children:[e.jsx("option",{value:"pix",children:"PIX"}),e.jsx("option",{value:"dinheiro",children:"Dinheiro"}),e.jsx("option",{value:"cartao_credito",children:"Cartão de crédito"}),e.jsx("option",{value:"cartao_debito",children:"Cartão de débito"}),e.jsx("option",{value:"transferencia",children:"Transferência"}),e.jsx("option",{value:"convenio",children:"Convênio"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:t.status,onChange:s=>c({...t,status:s.target.value}),className:"input-field",children:[e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"pago",children:"Pago"}),e.jsx("option",{value:"cancelado",children:"Cancelado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t.status==="pago"?"Data do pagamento":"Data de vencimento"}),e.jsx("input",{type:"date",value:t.status==="pago"?t.dataPagamento:t.dataVencimento,onChange:s=>c({...t,[t.status==="pago"?"dataPagamento":"dataVencimento"]:s.target.value}),className:"input-field"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),e.jsx("textarea",{value:t.observacoes,onChange:s=>c({...t,observacoes:s.target.value}),className:"input-field",rows:2})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:d,className:"btn-secondary",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn-primary",children:l?"Salvar":"Criar lançamento"})]})]})]})})}export{W as default};
